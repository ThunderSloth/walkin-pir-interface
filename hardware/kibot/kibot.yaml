kibot:
  version: 1

global:
  out_dir: .

preflight:
  check_zone_fills: true

outputs:
  # =============================
  # FAB (manufacturing outputs)
  # =============================
  - name: fab_gerbers
    type: gerber
    dir: fab/gerbers
    options:
      use_protel_extensions: true

  - name: fab_drill
    type: excellon
    dir: fab/gerbers
    options:
      metric_units: true

  # =============================
  # FAB DRAWING (autoscaled, relaxed)
  # =============================
  - name: fab_drawing
    type: pcb_print
    dir: docs/fab
    options:
      format: PDF
      output: "%f-fab-drawing.%x"
      plot_sheet_reference: true
      drill_marks: full
      scaling: 0
      autoscale_margin_x: 25
      autoscale_margin_y: 25
      pages:
        - title: "Fabrication Drawing"
          monochrome: true
          mirror: false
          colored_holes: false
          layers:
            - layer: Edge.Cuts
              use_for_center: true
            - User.Drawings
            - Dwgs.User

  # =============================
  # Assembly data (for you / assembler)
  # =============================
  - name: bom
    type: bom
    dir: assembly
    options:
      format: CSV

  - name: cpl
    type: position
    dir: assembly
    options:
      format: CSV
      output: "%f-pickplace-%i.%x"
      units: millimeters
      separate_files_for_front_and_back: true
      only_smd: true

  # =============================
  # Assembly drawings (autoscaled, more margin)
  # =============================
  - name: assy_top
    type: pcb_print
    dir: docs/assembly
    options:
      format: PDF
      output: "%f-assembly-top.%x"
      plot_sheet_reference: true
      scaling: 0
      autoscale_margin_x: 20
      autoscale_margin_y: 20
      pages:
        - title: "Assembly Drawing (Top)"
          monochrome: true
          mirror: false
          layers:
            - layer: Edge.Cuts
              use_for_center: true

            # Primary assembly geometry
            - layer: F.Fab

            # Optional but very nice
            - layer: F.CrtYd
              plot_footprint_refs: false
              plot_footprint_values: false

            # Your callouts, circles, notes
            - User.Drawings
  # =============================
  # MCAD (Fusion 360 enclosure)
  # =============================
  - name: mcad_step
    type: export_3d
    dir: mcad
    options:
      format: step
      origin: drill
      no_virtual: true

  # =============================
  # Documentation
  # =============================
  - name: schematic_pdf
    type: pdf_sch_print
    dir: docs/schematic
    options:
      monochrome: false

  - name: ibom
    type: ibom
    dir: docs/ibom
    options:
      highlight_pin1: true
      show_fabrication: false
      dark_mode: true

  # =============================
  # Board renders (2D)
  # =============================
  - name: pcbdraw_top
    type: pcbdraw
    dir: docs/renders
    options:
      bottom: false

  - name: pcbdraw_bottom
    type: pcbdraw
    dir: docs/renders
    options:
      bottom: true

